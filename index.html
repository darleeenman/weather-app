<!DOCTYPE html>
<html>
  <head>
    <title>Weather Sandbox</title>
    <meta charset="UTF-8" />
          <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
<style>
body {
  font-family: Helvetica;
  display: block;
  margin: 0 auto;
  border-radius: inherit;
  padding: 0 20px;
  text-align: center;
}
form {
  padding: 10px;
}
.mr-auto {
  display: block;
  margin: 0 auto;
}
.mr-auto .active {
  color: black;
  cursor: default;
}
.mr-auto .active:hover {
  text-decoration: none;
}
.card-weather {
  display: block;
  margin: 0 auto;
  padding: 50px 0px 50;
  max-width: 500px;
  background-color: lightblue;
}

.container-forecast {
  display: flex;
  flex-flow: row wrap;
  justify-content: space-around;
}
button {
  color: #000;
  background: #fff;
  border: 1px solid lightblue;
  border-radius: 10px;
  transition: all 200ms ease;
}
button:hover {
  color: #fff;
  background: lightblue;
}
.card-weather .weekly-weather-item {
  flex: 0 0 14.28%;
  border-right: 1px solid lightblue;
  padding: 1rem;
  text-align: center;
}
.units {
  position: relative;
  top: -34px;
  font-size: 15px;
  text-decoration: none;
}
.temperature {
  font-size: 50px;
}
.search-form {
  margin-bottom: -20px;
}
.current-button {
  position: relative;
  top: -24px;
  left: -170px;
  font-size: 15px;
  padding: 8px;
}
.stretch-card {
  display: block;
  margin: 0 auto;
}
ul {
  position: relative;
  right: -170px;
  top: -70px;
  line-height: 1;
}
li {
  position: relative;
  right: -45px;
  top: -15px;
  list-style: none;
  display: list-item;
}
</style>
  </head>

  <body>
    <!-- search form -->
    <form class="search-form" id="search-form">
      <input type="search" placeholder="Enter City" autofocus="on" autocomplete="off" id="city-input" />
      <input type="submit" value="search"/>
    </form>
    
    
<!---current location button-->
      <button class="current-button" id="current-button">Current</button>

      <br />
      
      <div class="col-lg-8 grid-margin stretch-card">
    <!-- weather card -->
    <div class="card card-weather">
      <div class="card-body">
        <div class="weather-date-location">
          <h5 id="MonthDayYear">October 22, 2022</h5>
          <p class="text-grey">
            <p id="date"></p>
            <br />
            <h3 id="city">...</h3>
          </p>
        </div>
        <div class="weather-data d-flex">
          <div class="mr-auto">
              <img id="icon" />
            <span class="temperature" id="current-temp">... </span>
              <span class="units">
                <a href="#" id="celsius-link" class="active">°C</a> |
                <a href="#" id="fahrenheit-link">°F</a></span>
       

            <p id="temperature-description">...</p>
            
            <ul>
              <li id="humidity"></li>
            <li id="wind"></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="card-body p-0">
        <div class="d-flex justify-content-around">

          <!-- sunday -->
          <div class="weekly-weather-item">
            <p class="mb-01">
              Sun
            </p>
            
            <p class="mb-0">
              74&deg;
            </p>
          </div>

          <!-- monday -->
          <div class="weekly-weather-item">
            <p class="mb-01">
              Mon
            </p>
            
            <p class="mb-0">
              77&deg;
            </p>
          </div>

          <!-- tuesday -->
          <div class="weekly-weather-item">
            <p class="mb-01">
              Tue
            </p>
            
            <p class="mb-0">
              75&deg;
            </p>
          </div>

          <!-- wednesday -->
          <div class="weekly-weather-item">
            <p class="mb-01">
              Wed
            </p> 
          
          <p class="mb-0">
            72&deg;
          </p>
        </div>

        <!-- thursday -->
        <div class="weekly-weather-item">
          <p class="mb-01">
            Thu
          </p>
        
        <p class="mb-0">
          74&deg;
        </p>
      </div>
    </div>
  </div>
</div>
<small>
  <a href="https://github.com/darleeenman/GitHub-projects" target="_blank">Open-source code</a>, by Darleen Man
</small>
<!-- weather card ends -->
</div>
</div>
</div>
</div>
</div>

    <script>
// date 
const d = new Date();
document.getElementById("MonthDayYear").innerHTML = d.toDateString();


// date + time
function formatDate(date) {
  let hours = date.getHours();
  if (hours < 10) {
    hours = `0${hours}`;
  }
  let minutes = date.getMinutes();
  if (minutes < 10) {
    minutes = `0${minutes}`;
  }

  // let dayIndex = date.getDay();
  // let days = [
  //   "Sunday",
  //   "Monday",
  //   "Tuesday",
  //   "Wednesday",
  //   "Thursday",
  //   "Friday",
  //   "Saturday",
  // ];
  // let day = days[dayIndex];

  return `${hours}:${minutes}`;
}

// search
function search(event) {
  event.preventDefault();
  let cityElement = document.querySelector("#city");
  let cityInput = document.querySelector("#city-input");
  cityElement.innerHTML = cityInput.value;
}


// date
let dateElement = document.querySelector("#date");
let currentTime = new Date();
dateElement.innerHTML = formatDate(currentTime);

// search form
let searchForm = document.querySelector("#search-form");
searchForm.addEventListener("submit", handleSubmit);



// conversion C - F
// function convertToFahrenheit(event) {
//   event.preventDefault();
//   let temperatureElement = document.querySelector("#temperature");
// }

// function convertToCelsius(event) {
//   event.preventDefault();
//   let temperatureElement = document.querySelector("#temperature");
// }

var celsiusTemperature = response.data.main.temp;

// current button
let currentButton = document.querySelector("#current-button");
currentButton.addEventListener("click", handleCurrentLocation);


let apiKey = "63dfb39dc38318c0c7e200e9557dfa6f";

// lat + lon location
function getLocation(position) {        
  let lat = position.coords.latitude;
  let lon = position.coords.longitude;
  let apiByLatLon = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;
        
  axios.get(apiByLatLon).then(getWeather);
      }

// main weather function
function getWeather(response) {
  let temperature = Math.round(response.data.main.temp);
  let city = response.data.name

  let h3 = document.querySelector("#city");
  let currentTemp = document.querySelector("#current-temp"); 

  let description = document.querySelector("#temperature-description");
  description.innerHTML = response.data.weather[0].description;

  let humidityElement = document.querySelector("#humidity");
  humidityElement.innerHTML = response.data.main.humidity;

  let windElement = document.querySelector("#wind");
  windElement.innerHTML = Math.round(response.data.wind.speed);

  let iconElement = document.querySelector("#icon");
  iconElement.setAttribute("src", `http://openweathermap.org/img/wn/${response.data.weather[0].icon}@2x.png`);

  h3.innerHTML = city;
  currentTemp.innerHTML = temperature;
      }
navigator.geolocation.getCurrentPosition(getLocation);

// search city
function searchCity(city) {
let apiByCity = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metrics&appid=${apiKey}`;
axios.get(apiByCity).then(getWeather);
}
function handleSubmit(event) {
  event.preventDefault();
  let cityInputElement = document.querySelector("#city-input");
  searchCity(cityInputElement.value);
}

// current location button
function handleCurrentLocation(event) {
  event.preventDefault();
  navigator.geolocation.getCurrentPosition(getLocation);
}

// fahrenheit temperature
function displayFahrenheitTemperature(event) {
  event.preventDefault();  
  let temperatureElement = document.querySelector("#temperature");

  celsiusLink.classlist.remove("active");
  fahrenheitLink.classlist.add("active");
  let fahrenheitTemperature = (celsiusTemperature * 9) / 5 + 32;
  temperatureElement.innerHTML = Math.round(fahrenheitTemperature);
}


// celsius temperature
function displayCelsiusTemperature(event) {
  event.preventDefault();
  celsiusLink.classlist.add("active");
  fahrenheitLink.classlist.remove("active");
  let temperatureElement = doucment.querySelector("#temperature");
  temperatureElement.innerHTML = Math.round(celsiusTemperature);
}

let celsiusTemperature = null;

// click convert
let fahrenheitLink = document.querySelector("#fahrenheit-link");
fahrenheitLink.addEventListener("click", displayFahrenheitTemperature);

let celsiusLink = document.querySelector("#celsius-link");
celsiusLink.addEventListener("click", displayCelsiusTemperature);

</script>
  </body>
</html>